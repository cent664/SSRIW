# Robust Image Watermarking based on Cross-Attention and Invariant Domain Learning
---

[Explanation video](https://unomaha.yuja.com/V/Video?v=9291369&a=119095956)

[Link to pretrained weights
](https://drive.google.com/drive/folders/1GHNU1KFDcLaGMpALDvrFVxEtAlnP5ZXF?usp=sharing)

**Cross-attention for image watermarking:**
---
We propose utilizing MHA in image watermarking to allocate watermarks across various regions based on relevance. The figure illustrates the decomposition of the cover image and watermark into vectors which are then embedded  with positional embeddings. These vectors are then processed through an MHA layer, computing attention scores between patches from one image (as queries) and the other (as keys), facilitating understanding between the cover image and the watermark. These scores are then utilized to identify optimal watermark embedding locations.
![cross_attention_watermarking](https://github.com/cent664/SSRIW/assets/44358874/fe6788ba-c69e-4fba-8c53-f0ee42020105)



**Architecture overview:**
---
![Architecture](https://github.com/cent664/SSRIW/assets/44358874/81748e20-d762-4330-beef-5ddef1bd82f2)



**Watermark generation example:**
---
(Left) A sample 128x128x3 cover image from our subset of the imagenet validation set.
(Right) The watermark generated by resizing, isolating the first channel and binarizing the pixels which range from 0 to 255, to 0 or 1, based on the threshold 128 (half of 255).
![watermark_generation](https://github.com/cent664/SSRIW/assets/44358874/29129023-6d8f-4383-8b63-6cd444b379f3)



**Watermark embedding location:**
---
Figure illustrating the pixels affected by the embedding process for each case by showcasing the difference between the cover image and their respective marked image. 
![watermark_location](https://github.com/cent664/SSRIW/assets/44358874/a066ecc7-edc3-4c99-923c-f434b7751db5)



**Noise tolerance study:**
---
We perform an experiment to test the tolerance of our proposed scheme against increasing levels of noises. As expected the performance decreases steadily with an increase in the degree of noise.
![noise_tolerance](https://github.com/cent664/SSRIW/assets/44358874/ae75705b-813c-4fb0-a010-6c62864d1021)


**Paper Citation:**
---
A. Dasgupta and X. Zhong, "Robust Image Watermarking Based on Cross-Attention and Invariant Domain Learning," 2023 International Conference on Computational Science and Computational Intelligence (CSCI), Las Vegas, NV, USA, 2023, pp. 1125-1132, doi: 10.1109/CSCI62032.2023.00185.

https://ieeexplore.ieee.org/document/10590390
